# Gemini OCR 애플리케이션

이 애플리케이션은 Google의 Gemini API를 사용하여 이미지에서 텍스트를 추출하고 구조화된 데이터로 변환하는 도구입니다.

## 목차

1. [소개](#소개)
2. [설치 방법](#설치-방법)
3. [사용 방법](#사용-방법)
4. [주요 기능](#주요-기능)
5. [문제 해결](#문제-해결)
6. [자주 묻는 질문](#자주-묻는-질문)

## 소개

Gemini OCR 애플리케이션은 Google의 강력한 Gemini AI 모델을 활용하여 이미지에서 텍스트를 추출하고 구조화된 데이터로 변환합니다. 이 애플리케이션은 다음과 같은 특징을 가지고 있습니다:

- 사용자 친화적인 그래픽 인터페이스
- 개별 이미지 또는 폴더 단위 처리 지원
- API 키 안전한 저장 및 관리
- 다양한 Gemini 모델 지원
- 사용자 정의 프롬프트 설정
- 결과를 Excel 파일로 저장

## 설치 방법

### 방법 1: 실행 파일 다운로드 (권장)

1. 최신 릴리스에서 `GeminiOCR.exe` 파일을 다운로드합니다.
2. 다운로드한 파일을 실행합니다.
3. 애플리케이션이 자동으로 시작됩니다.

### 방법 2: 소스 코드에서 실행

1. 이 저장소를 클론하거나 다운로드합니다.
2. 필요한 패키지를 설치합니다:
   ```
   pip install PyQt5 google-generativeai pandas openpyxl Pillow
   ```
3. 애플리케이션을 실행합니다:
   ```
   python gemini_gui.py
   ```

### 방법 3: 소스 코드에서 실행 파일 빌드

1. 이 저장소를 클론하거나 다운로드합니다.
2. 필요한 패키지를 설치합니다:
   ```
   pip install PyQt5 google-generativeai pandas openpyxl Pillow pyinstaller
   ```
3. 빌드 스크립트를 실행합니다:
   ```
   python build.py
   ```
4. 빌드가 완료되면 `dist` 폴더에서 `GeminiOCR.exe` 파일을 찾을 수 있습니다.

## 사용 방법

### 1. API 키 설정

1. [Google AI Studio](https://makersuite.google.com/app/apikey)에서 Gemini API 키를 발급받습니다.
2. 애플리케이션의 'OCR 처리' 탭 또는 '설정' 탭에서 API 키를 입력하고 '저장' 버튼을 클릭합니다.

### 2. 이미지 선택

1. '이미지 파일' 옵션을 선택하여 개별 이미지를 선택하거나, '폴더' 옵션을 선택하여 폴더 내의 모든 이미지를 처리할 수 있습니다.
2. '찾아보기' 버튼을 클릭하여 이미지 파일이나 폴더를 선택합니다.
3. 선택된 이미지는 목록에 표시됩니다. '모두 지우기' 또는 '선택 항목 제거' 버튼을 사용하여 목록을 관리할 수 있습니다.

### 3. 출력 설정

1. '출력 파일' 필드에 결과를 저장할 Excel 파일의 경로를 지정합니다.
2. '찾아보기' 버튼을 클릭하여 파일 위치를 선택할 수 있습니다.

### 4. 프롬프트 설정

1. '직접 입력' 옵션을 선택하여 텍스트 영역에 프롬프트를 입력하거나, '파일에서 로드' 옵션을 선택하여 프롬프트 파일을 로드할 수 있습니다.
2. 프롬프트는 Gemini API에게 이미지에서 어떤 정보를 추출할지 지시하는 역할을 합니다.

### 5. OCR 처리 실행

1. 모든 설정을 완료한 후 'OCR 처리 시작' 버튼을 클릭하여 처리를 시작합니다.
2. 진행 상황이 진행 표시줄에 표시됩니다.
3. 처리가 완료되면 결과가 지정된 Excel 파일에 저장됩니다.

## 주요 기능

### API 키 관리

- API 키를 안전하게 로컬 시스템에 저장합니다.
- API 키 표시/숨김 기능을 제공합니다.

### 이미지 처리

- 개별 이미지 또는 폴더 단위 처리를 지원합니다.
- 지원되는 이미지 형식: JPG, JPEG, PNG, BMP, GIF
- 이미지 목록 관리 기능을 제공합니다.

### 모델 선택

- 다양한 Gemini 모델을 선택할 수 있습니다:
  - gemini-2.0-flash: 빠른 처리 속도, 일반적인 OCR 작업에 적합
  - gemini-2.0-pro: 더 높은 정확도, 복잡한 OCR 작업에 적합
  - gemini-1.5-flash: 이전 버전, 빠른 처리 속도
  - gemini-1.5-pro: 이전 버전, 높은 정확도

### 프롬프트 설정

- 직접 입력 또는 파일에서 로드 옵션을 제공합니다.
- 사용자 정의 프롬프트를 통해 추출할 정보를 지정할 수 있습니다.

### 결과 저장

- 결과를 Excel 파일로 저장합니다.
- 각 이미지의 처리 결과가 구조화된 형식으로 저장됩니다.

## 문제 해결

### API 키 오류

- API 키가 올바르지 않은 경우: API 키를 다시 확인하고 올바르게 입력했는지 확인하세요.
- API 할당량 초과: Google AI Studio에서 API 사용량을 확인하고 필요한 경우 할당량을 늘리세요.

### 이미지 처리 오류

- 지원되지 않는 이미지 형식: 지원되는 이미지 형식(JPG, JPEG, PNG, BMP, GIF)인지 확인하세요.
- 이미지 크기가 너무 큰 경우: 이미지 크기를 줄여보세요.
- 이미지 품질이 낮은 경우: 더 선명한 이미지를 사용해보세요.

### 결과 품질 문제

- 결과가 예상과 다른 경우: 프롬프트를 더 구체적으로 작성하여 Gemini API에게 명확한 지시를 제공하세요.
- 구조화된 데이터 형식이 일관되지 않은 경우: 프롬프트에 원하는 출력 형식을 명확하게 지정하세요.

## 자주 묻는 질문

### Q: API 키는 어디에서 얻을 수 있나요?
A: [Google AI Studio](https://makersuite.google.com/app/apikey)에서 Gemini API 키를 발급받을 수 있습니다.

### Q: API 키는 어디에 저장되나요?
A: API 키는 사용자의 홈 디렉토리 내 `.gemini_ocr` 폴더의 `config.ini` 파일에 저장됩니다.

### Q: 어떤 모델을 선택해야 하나요?
A: 일반적인 OCR 작업에는 'gemini-2.0-flash'를 권장합니다. 더 높은 정확도가 필요한 복잡한 작업에는 'gemini-2.0-pro'를 사용해보세요.

### Q: 프롬프트는 어떻게 작성해야 하나요?
A: 프롬프트는 Gemini API에게 이미지에서 어떤 정보를 추출할지 지시하는 역할을 합니다. 예를 들어, "이미지에서 모든 텍스트를 추출하고 표 형식으로 구성해주세요."와 같이 작성할 수 있습니다.

### Q: 결과 파일의 형식을 변경할 수 있나요?
A: 현재 버전에서는 Excel 파일(.xlsx) 형식만 지원합니다.

### Q: 애플리케이션을 업데이트하려면 어떻게 해야 하나요?
A: 최신 버전을 다운로드하여 설치하면 됩니다. 설정은 자동으로 유지됩니다.
